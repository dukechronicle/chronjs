script
    $(document).ready(function(){

        $(".delete").click(function(event) {
            event.preventDefault();

            var anchor = $(event.target);
            var id = anchor.attr('data-id');
            
            $.getJSON(
                '/admin/image/articles',
                {id: id},
                function(data) {
                
                    var msg = '<div id="dialog-confirm">This image will be removed from the following articles:<ul>';
                    $.each(data, function(index, value) {
                        msg += '<li>' + value.title + '</li>';
                    });
                    msg += '</ul></div>';
                    
                    $(msg).appendTo('body');

                    $("#dialog-confirm").dialog({
                        dialogClass: 'delete-confirmation-dialog',
                        title: 'Delete Image',
                        resizable: false,
                        autoOpen: true,
                        height:140,
                        modal: true,
                        buttons: {
                            "Delete": function() {
                                $.getJSON(
                                    '/admin/image/delete',
                                    {id: id},
                                    function(data) {
                                        location.reload();
                                    }
                                );
                            },
                            Cancel: function() {
                                $(this).remove();
                            }
                        }
                    });
                }
            );

            

        });
    });

h1 Crop
- if(url)
  img#toCrop(src=url)
p
  select#sizes(onchange="updateCropSize()")
    - each name in imageTypes
      option(value=name) #{name}
  &nbsp;
  a(onClick="showDescriptions()") What's This?
- var json = JSON.stringify(imageDetails);
script(src='/js/crop.js', type='text/javascript')
script(src='/js/nicedate.js', type='text/javascript')
script
  setSizes('!{json}');
  updateCropSize();
  setDateStuff("#nicedate","#date","#infoform");
p
  form#coords(action='/admin/image/crop', method='POST')
    input#fWidth(type='hidden', name='finalWidth')
    input#fHeight(type='hidden', name='finalHeight')
    input#x1(type='hidden', name='x1')
    input#x2(type='hidden', name='x2')
    input#y1(type='hidden', name='y1')
    input#y2(type='hidden', name='y2')
    input(type='hidden', name='name', value=name)
    - if(article)
      input(type='hidden', name='article', value=article)
    input(type='submit')
p
  br
  form(id="infoform", action='/admin/image/info', method='POST')
    span Name: 
    input(type='text', name='name', value=name)
    br
    span Caption: 
    input(type='text', name='caption', value=caption)
    br
    span Location: 
    input(type='text', name='location', value=location)
    br
    span Photographer: 
    input(type='text', name='photographer', value=photographer)
    br
    span Date: 
    input(id='nicedate', type='text', name='nicedate', value=date)
    input(id='date', type='hidden', name='date', value=date)
    input(type='hidden', name='id', value=id)
    br
    input(type='submit')

- if(versions.length > 0)
  hr
  - if(!article)
    h1 Existing Versions
  - else
    h1 Existing Versions (click to add to article)
  #versions!= partial('version', {collection: versions, locals: {article: article, imageTypes: imageTypes, cropSizes: imageDetails}})
